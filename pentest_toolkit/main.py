from port_scanner import PortScanner
from brute_forcer import BruteForcer
from vuln_scanner import VulnScanner

def main():
    print("Welcome to PentestToolkit - Modular Penetration Testing Toolkit")
    print("Modules: 1. Port Scanner, 2. Brute-Forcer, 3. Vulnerability Scanner")
    choice = input("Select a module (1-3): ").strip()

    if choice == '1':
        target_ip = input("Enter target IP: ").strip()
        start_port = int(input("Start port (default 1): ") or 1)
        end_port = int(input("End port (default 1024): ") or 1024)
        scanner = PortScanner(target_ip, start_port, end_port)
        scanner.scan()

    elif choice == '2':
        target_ip = input("Enter target IP: ").strip()
        username = input("Username: ").strip()
        wordlist = input("Path to wordlist file: ").strip()
        port = int(input("SSH port (default 22): ") or 22)
        brute = BruteForcer(target_ip, username, wordlist, port)
        brute.brute_force()

    elif choice == '3':
        url = input("Enter URL to scan: ").strip()
        scanner = VulnScanner(url)
        scanner.scan()

    else:
        print("Invalid choice.")

if __name__ == "__main__":
    main()